<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <title>Mail Sender</title>

  <!-- Bootstrap CSS -->
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
    crossorigin="anonymous"
  />

  <!-- Quill CSS -->
  <link href="https://cdn.jsdelivr.net/npm/quill@1.3.7/dist/quill.snow.css" rel="stylesheet" />
</head>
<body>
  <div class="container py-4">
    <h1 class="mb-4">Send Mail</h1>

    <div id="formWrap" class="card">
      <div class="card-body">
        <form id="mailForm" novalidate>
          <div class="row g-3">

            <!-- Gmail user/pass -->
            <div class="col-md-6">
              <label for="user" class="form-label">Gmail Address *</label>
              <input id="user" name="user" type="email" class="form-control" required />
            </div>
            <div class="col-md-6">
              <label for="pass" class="form-label">Gmail App Password *</label>
              <input id="pass" name="pass" type="password" class="form-control" required />
            </div>

            <div class="col-12"><hr/></div>

            <!-- Bulk via Excel (moved up) -->
            <div class="col-lg-6">
              <label for="excelFile" class="form-label">Upload Excel (XLSX/XLS)</label>
              <input id="excelFile" type="file" class="form-control" accept=".xlsx,.xls" />
            </div>
            <div class="col-lg-3">
              <label for="delaySec" class="form-label">Delay (seconds) *</label>
              <input id="delaySec" type="number" class="form-control" min="5" value="5" />
            </div>
            <div class="col-lg-3 d-flex align-items-end">
              <button type="button" id="verifyBtn" class="btn btn-outline-primary w-100">Verify</button>
            </div>

            <div class="col-12">
              <div id="verifyResult" class="border rounded p-3">
                <div class="text-muted">No file verified yet.</div>
              </div>
            </div>

            <div class="col-12"><hr/></div>

            <!-- Recipients (single send fallback) -->
            <div class="col-12">
              <label for="to" class="form-label">To (used if no Excel) *</label>
              <input id="to" name="to" type="text" class="form-control" placeholder="alice@example.com" />
            </div>
            <div class="col-md-6">
              <label for="cc" class="form-label">Cc</label>
              <input id="cc" name="cc" type="text" class="form-control" />
            </div>
            <div class="col-md-6">
              <label for="bcc" class="form-label">Bcc</label>
              <input id="bcc" name="bcc" type="text" class="form-control" />
            </div>

            <!-- Subject -->
            <div class="col-12">
              <label for="subject" class="form-label">Subject (supports {{Placeholders}})</label>
              <input id="subject" name="subject" type="text" class="form-control" />
            </div>

            <!-- Body with Quill -->
            <div class="col-12">
              <label class="form-label">Body (supports {{Placeholders}}) *</label>
              <div id="toolbar"></div>
              <div id="editor"></div>
            </div>

            <!-- Attachments -->
            <div class="col-12">
              <label for="attachments" class="form-label">Attachments</label>
              <input id="attachments" name="attachments" type="file" class="form-control" multiple />
            </div>

            <div class="col-12 d-flex gap-2 mt-2">
              <button id="startBtn" type="button" class="btn btn-success">Start Sending</button>
              <button id="stopBtn" type="button" class="btn btn-danger" disabled>Stop Sending</button>
              <a id="downloadBtn" href="#" class="btn btn-outline-secondary ms-auto d-none" download>Download Updated Excel</a>
            </div>
          </div>
        </form>
      </div>
    </div>

    <!-- Status Log (textarea) -->
    <div class="mt-4">
      <h5>Status Log</h5>
      <textarea id="statusLog" class="form-control" rows="12" readonly></textarea>
    </div>

    <p class="text-muted small mt-3 mb-0">
      Server endpoint: <code>POST /send</code>
    </p>
  </div>

  <!-- Bootstrap JS -->
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"
  ></script>

  <!-- Quill JS -->
  <script src="https://cdn.jsdelivr.net/npm/quill@1.3.7/dist/quill.min.js"></script>

  <!-- SheetJS for Excel -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

  <!-- App Script -->
  <script src="script.js"></script>
</body>
</html>
